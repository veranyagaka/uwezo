<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kenya Cities Incident Hotspots</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a202c;
            color: #ffffff;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .description {
            background-color: #2d3748;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .map-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        .map-container {
            background-color: #2d3748;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .map-container h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .map {
            height: 400px;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .legend {
            background-color: #2d3748;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .legend h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Kenya Cities Incident Hotspots</h1>
        <div class="description">
            <p>This page shows real-time hotspots of reported incidents across four major cities in Kenya. The size and color intensity of each marker indicate the severity of the hotspot.</p>
        </div>
        <div class="map-grid">
            <div class="map-container">
                <h2>Nairobi</h2>
                <div id="map-nairobi" class="map"></div>
            </div>
            <div class="map-container">
                <h2>Mombasa</h2>
                <div id="map-mombasa" class="map"></div>
            </div>
            <div class="map-container">
                <h2>Kisumu</h2>
                <div id="map-kisumu" class="map"></div>
            </div>
            <div class="map-container">
                <h2>Nakuru</h2>
                <div id="map-nakuru" class="map"></div>
            </div>
        </div>
        <div class="legend">
            <h2>Legend</h2>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #E34234;"></div>
                <span>Low Intensity (1-3)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #DC143C;"></div>
                <span>Medium-Low Intensity (4-5)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #B22222;"></div>
                <span>Medium-High Intensity (6-7)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #8B0000;"></div>
                <span>High Intensity (8-10)</span>
            </div>
        </div>
    </div>

    <script>
        const cities = {
            nairobi: { center: [-1.2921, 36.8219], zoom: 12 },
            mombasa: { center: [-4.0435, 39.6682], zoom: 12 },
            kisumu: { center: [-0.1022, 34.7617], zoom: 12 },
            nakuru: { center: [-0.3031, 36.0800], zoom: 12 }
        };

        const maps = {};

        for (const [city, data] of Object.entries(cities)) {
            maps[city] = L.map(`map-${city}`).setView(data.center, data.zoom);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(maps[city]);
        }

        const getHotspotColor = (intensity) => {
            if (intensity > 7) return '#8B0000';
            if (intensity > 5) return '#B22222';
            if (intensity > 3) return '#DC143C';
            return '#E34234';
        };

        const generateHotspots = (center, count) => {
            const hotspots = [];
            for (let i = 1; i <= count; i++) {
                const lat = center[0] + (Math.random() - 0.5) * 0.1;
                const lng = center[1] + (Math.random() - 0.5) * 0.1;
                hotspots.push({
                    id: i,
                    lat,
                    lng,
                    intensity: Math.floor(Math.random() * 10) + 1,
                    location: `Location ${i}`
                });
            }
            return hotspots;
        };

        const cityHotspots = {
            nairobi: generateHotspots(cities.nairobi.center, 10),
            mombasa: generateHotspots(cities.mombasa.center, 8),
            kisumu: generateHotspots(cities.kisumu.center, 6),
            nakuru: generateHotspots(cities.nakuru.center, 7)
        };

        function updateHotspots() {
            for (const [city, hotspots] of Object.entries(cityHotspots)) {
                maps[city].eachLayer(layer => {
                    if (layer instanceof L.CircleMarker) {
                        maps[city].removeLayer(layer);
                    }
                });

                hotspots.forEach(hotspot => {
                    hotspot.intensity = Math.floor(Math.random() * 10) + 1;
                    L.circleMarker([hotspot.lat, hotspot.lng], {
                        radius: hotspot.intensity * 2,
                        fillColor: getHotspotColor(hotspot.intensity),
                        color: getHotspotColor(hotspot.intensity),
                        weight: 2,
                        fillOpacity: 0.7
                    }).addTo(maps[city]).bindPopup(`
                        <strong>${hotspot.location}</strong><br>
                        Hotspot ID: ${hotspot.id}<br>
                        Intensity: ${hotspot.intensity}<br>
                        Coordinates: ${hotspot.lat.toFixed(4)}, ${hotspot.lng.toFixed(4)}
                    `);
                });
            }
        }

        updateHotspots();
        setInterval(updateHotspots, 5000);
    </script>
</body>
</html>